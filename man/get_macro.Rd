% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/helpers.R
\name{get_macro}
\alias{get_macro}
\title{Fetch and Analyze Macroeconomic Indicators for Crypto Markets}
\usage{
get_macro(
  fred_api_key = global_variables$fred_api_key,
  start_date = "2015-01-01"
)
}
\arguments{
\item{fred_api_key}{Character string containing your FRED API key. Default
looks for \code{global_variables$fred_api_key}. Get a free API key at
\url{https://fred.stlouisfed.org/docs/api/api_key.html}}

\item{start_date}{Start date for historical data in "YYYY-MM-DD" format.
Default "2015-01-01" aligns with crypto market maturity.}
}
\value{
A list object of class \code{macro_data} containing:

  \strong{Liquidity Conditions:}
  \itemize{
    \item \code{m2_us}: Raw M2 money supply data from FRED
    \item \code{m2_yoy}: Year-over-year percentage change in M2
    \item \code{m2_mom}: Month-over-month percentage change in M2
    \item \code{liquidity_regime}: Categorical regime:
      \itemize{
        \item "Expanding": M2 YoY > 5% (bullish for crypto)
        \item "Stable": M2 YoY between 0% and 5%
        \item "Contracting": M2 YoY < 0% (bearish for crypto)
      }
  }

  \strong{Interest Rate Environment:}
  \itemize{
    \item \code{treasury_10y}: 10-year Treasury yield data
    \item \code{real_rates}: Real yields (nominal yield minus inflation expectations)
    \item \code{rate_regime}: Categorical regime:
      \itemize{
        \item "Low Rates (Risk-On)": 10-year yield < 1% (bullish)
        \item "Neutral": Yields between 1% and 3%
        \item "High Rates (Risk-Off)": Yields > 3% (bearish)
      }
  }

  \strong{Dollar Strength:}
  \itemize{
    \item \code{dxy}: US Dollar Index (DXY) data from Yahoo Finance
    \item \code{dollar_regime}: Categorical regime:
      \itemize{
        \item "Weak Dollar (Bullish Crypto)": DXY < 90
        \item "Neutral": DXY between 90 and 100
        \item "Strong Dollar (Bearish Crypto)": DXY > 100
      }
  }

  \strong{Composite Risk Score:}
  \itemize{
    \item \code{composite_risk_score}: Weighted average (-1 to +1 scale) of:
      \itemize{
        \item M2 YoY growth (+1 if >5%, -1 if <0%, else 0)
        \item 10-year yield (+1 if <1%, -1 if >3%, else 0)
        \item DXY (+1 if <90, -1 if >100, else 0)
      }
    \item Interpretation:
      \itemize{
        \item \strong{> 0.3}: Bullish macro environment
        \item \strong{-0.3 to 0.3}: Neutral macro environment
        \item \strong{< -0.3}: Bearish macro environment
      }
  }
}
\description{
Retrieves and analyzes key macroeconomic indicators that have demonstrated
significant correlation with cryptocurrency markets. This function aggregates
global liquidity conditions, interest rates, dollar strength, and inflation
expectations into a composite risk score for crypto asset allocation.
}
\details{
\strong{Why Macro Matters for Crypto}

Cryptocurrency markets, despite their decentralized nature, have shown
increasing correlation with traditional macro factors. This function captures
the three most significant macro drivers:

\strong{1. Global Liquidity (M2 Money Supply)}

M2 represents broad money supply including cash, checking deposits, and
easily convertible near-money. Crypto has historically shown strong correlation
with global liquidity expansion:
\itemize{
  \item \strong{Expanding M2 (>5\% YoY)}: Excess liquidity flows into risk assets,
    including cryptocurrencies. This was a key driver of the 2017 and 2021 bull runs.
  \item \strong{Contracting M2 (<0\% YoY)}: Liquidity drains from markets,
    creating headwinds for crypto. The 2022 bear market coincided with M2 contraction.
  \item \strong{Leading Indicator}: Changes in M2 often precede crypto market
    moves by 2-3 months.
}

\strong{2. Interest Rates and Real Yields}

The 10-year Treasury yield represents the risk-free rate of return, while
real yields adjust for inflation expectations. These affect crypto through:
\itemize{
  \item \strong{Opportunity Cost}: Higher yields increase the opportunity cost
    of holding non-yielding assets like Bitcoin.
  \item \strong{Discount Rates}: Higher rates reduce the present value of
    future expected cash flows for crypto assets.
  \item \strong{Institution Allocation}: Real yields drive institutional
    allocation decisions between asset classes.
}

\strong{3. US Dollar Index (DXY)}

DXY measures the dollar's strength against a basket of major currencies.
The inverse correlation with crypto is well-documented:
\itemize{
  \item \strong{Weak Dollar (<90)}: Typically coincides with global risk-on
    sentiment and crypto appreciation.
  \item \strong{Strong Dollar (>100)}: Often associated with risk-off sentiment,
    capital flight to safety, and crypto depreciation.
  \item \strong{Mechanism}: A weaker dollar makes dollar-denominated assets
    cheaper for foreign investors and often reflects loose monetary policy.
}

\strong{Composite Risk Score Methodology}

The composite score provides a single metric for macro conditions:
\itemize{
  \item Each component is scored as +1 (bullish), 0 (neutral), or -1 (bearish)
  \item Scores are summed and divided by 3 (number of components)
  \item Range: -1 (maximum bearish) to +1 (maximum bullish)
  \item Example calculation for current conditions:
    \itemize{
      \item M2 YoY: +4.2\% → 0 (neutral)
      \item 10-year yield: 4.5\% → -1 (bearish)
      \item DXY: 95 → 0 (neutral)
      \item Composite = (0 + -1 + 0) / 3 = -0.33 (mildly bearish)
    }
}
}
\note{
\itemize{
  \item A FRED API key is required for M2, treasury yields, and inflation data.
    Register for free at \url{https://fred.stlouisfed.org/docs/api/api_key.html}
  \item DXY data is fetched from Yahoo Finance and may have different update schedules.
  \item First observation for YoY calculations will be NA (requires 12 months of data).
  \item The composite score weights each factor equally; advanced users may want
    to implement their own weighting schemes.
  \item Macro indicators are global in nature and should be used for
    medium to long-term positioning rather than short-term trading.
}
}
\section{Trading Applications}{

\itemize{
  \item \strong{Strategic Allocation}: Use composite score for long-term
    portfolio positioning (>3 month horizon)
  \item \strong{Regime Filter}: Only take long positions when macro composite > -0.3
  \item \strong{Hedging}: Increase hedges when rates regime is "High Rates (Risk-Off)"
  \item \strong{Confluence}: Look for alignment between macro regime and on-chain signals
}
}

\examples{
\dontrun{
# Basic usage with your FRED API key
macro <- get_macro(fred_api_key = "your_api_key_here")

# View current macro regime
cat("Liquidity:", macro$liquidity$liquidity_regime, "\n")
cat("Rates:", macro$rates$rate_regime, "\n")
cat("Dollar:", macro$dollar$dollar_regime, "\n")
cat("Composite Risk Score:", round(macro$composite_risk_score, 2), "\n")

# Interpret composite score
score <- macro$composite_risk_score
if (score > 0.3) {
  cat("Bullish macro environment - favorable for crypto\n")
} else if (score < -0.3) {
  cat("Bearish macro environment - headwinds for crypto\n")
} else {
  cat("Neutral macro environment\n")
}

# Plot M2 growth history
library(ggplot2)
m2_data <- data.frame(
  date = macro$liquidity$m2_us$date,
  m2_yoy = macro$liquidity$m2_yoy * 100
) \%>\% tidyr::drop_na()

ggplot(m2_data, aes(x = date, y = m2_yoy)) +
  geom_line() +
  geom_hline(yintercept = c(0, 5), linetype = "dashed", color = "red") +
  labs(title = "M2 Money Supply YoY Growth",
       subtitle = ">5\% = Expanding Liquidity, <0\% = Contracting",
       y = "Year-over-Year \% Change")

# Track macro conditions over time
macro_history <- function(start_date = "2020-01-01") {
  dates <- seq.Date(as.Date(start_date), Sys.Date(), by = "month")
  scores <- sapply(dates, function(d) {
    # Note: This is simplified - you'd need to fetch data for each date
    macro <- get_macro(fred_api_key = "your_key", start_date = d - 365)
    return(macro$composite_risk_score)
  })
  return(data.frame(date = dates, score = scores))
}
}

}
\references{
\itemize{
  \item Federal Reserve Economic Data (FRED): \url{https://fred.stlouisfed.org/}
  \item Bordo, M. D., & Levin, A. T. (2017). Central Bank Digital Currency
    and the Future of Monetary Policy
  \item Conlon, T., & McGee, R. (2020). Safe Haven or Risky Hazard? Bitcoin
    during the Covid-19 Bear Market
  \item Kristoufek, L. (2015). What Are the Main Drivers of the Bitcoin Price?
    Evidence from Wavelet Coherence Analysis
}
}
\seealso{
\itemize{
  \item \code{\link{get_onchain_indicators}} for fundamental crypto valuation
  \item \code{\link{get_derivatives}} for market positioning signals
  \item \code{\link{crypto_predictive_framework}} for integrated analysis
}
}
\author{
Filippo Franchini
}
