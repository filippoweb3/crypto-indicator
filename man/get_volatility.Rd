% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/helpers.R
\name{get_volatility}
\alias{get_volatility}
\title{Calculate Cryptocurrency Volatility Metrics and Regimes}
\usage{
get_volatility(data, windows = list(short = 7, medium = 30, long = 90))
}
\arguments{
\item{data}{A data frame containing cryptocurrency price data, typically the
output from \code{\link{get_onchain_indicators()}}. Must contain a column
\code{log_returns} with logarithmic returns.}

\item{windows}{A list specifying the rolling windows for volatility calculation:
\itemize{
  \item \code{short}: Window for short-term volatility (default: 7 days)
  \item \code{medium}: Window for medium-term volatility (default: 30 days)
  \item \code{long}: Window for long-term volatility (default: 90 days)
}}
}
\value{
A list object of class \code{volatility_data} containing:

  \strong{Volatility Series:}
  \itemize{
    \item \code{volatility$short}: Short-term realized volatility (annualized)
    \item \code{volatility$medium}: Medium-term realized volatility (annualized)
    \item \code{volatility$long}: Long-term realized volatility (annualized)
    \item \code{volatility$percentile_short}: Percentile rank of short-term vol (0-1)
    \item \code{volatility$percentile_medium}: Percentile rank of medium-term vol (0-1)
  }

  \strong{Volatility Regime:}
  \itemize{
    \item \code{regime}: Categorical regime for each observation:
      \itemize{
        \item "Extreme Low": Volatility < mean - 1sd
        \item "Low": Volatility between mean and mean - 1sd
        \item "High": Volatility between mean and mean + 1sd
        \item "Extreme High": Volatility > mean + 1sd
      }
  }

  \strong{Trading Signals:}
  \itemize{
    \item \code{signals$vol_breakout}: Logical vector - TRUE when short-term vol
      exceeds 1.5Ã— medium-term vol (momentum strategy setup)
    \item \code{signals$vol_compression}: Logical vector - TRUE when short-term vol
      is less than 0.5Ã— medium-term vol (mean reversion strategy setup)
    \item \code{signals$current_regime}: Human-readable description of the
      current market environment:
      \itemize{
        \item "Risk-Off (Capitulation)": Extreme High volatility - panic selling
        \item "Active Trading": High volatility - opportunities with tight stops
        \item "Trend Following": Low volatility - ideal for trend strategies
        \item "Complacency (Watch for Breakout)": Extreme Low volatility - big move imminent
      }
  }
}
\description{
Computes realized volatility across multiple time horizons and identifies
volatility regimes to determine optimal trading strategies. This function
is essential for adapting trading approaches to market conditions, as
different volatility environments favor different strategies.
}
\details{
\strong{Volatility Calculation Methodology}

Realized volatility is calculated as the standard deviation of log returns,
annualized by multiplying by the square root of 365 (trading days):

\deqn{\sigma_t = \sqrt{252} \times \sqrt{\frac{1}{n-1}\sum_{i=t-n+1}^{t} (r_i - \bar{r})^2}}

Where:
\itemize{
  \item \eqn{r_i} are log returns
  \item \eqn{n} is the window size (7, 30, or 90 days)
  \item Annualization factor: \eqn{\sqrt{365}} for daily crypto trading
}

\strong{Why Volatility Matters}

Volatility is not just risk to be managedâ€”it's a regime indicator that
determines which trading strategies are most likely to succeed:

\strong{Low Volatility Regimes (Trend Following)}

When volatility is low (below historical mean), markets tend to exhibit
persistent trends with limited noise. This environment favors:
\itemize{
  \item Trend-following strategies (moving average crossovers)
  \item Breakout systems
  \item Longer holding periods
  \item Wider stop losses (to avoid being shaken out)
}

\strong{High Volatility Regimes (Active Trading)}

When volatility is high (above historical mean), markets become noisy with
frequent sharp reversals. This environment favors:
\itemize{
  \item Mean reversion strategies
  \item Shorter timeframes
  \item Tighter stop losses
  \item Range-bound trading systems
}

\strong{Extreme Volatility Regimes}

\itemize{
  \item \strong{Extreme High (> +1sd)}: Capitulation or panic selling.
    Often marks short-term bottoms as selling exhausts itself.
    Strategy: Wait for stabilization, then buy on first pullback.

  \item \strong{Extreme Low (< -1sd)}: Market complacency.
    Low volatility periods are typically followed by volatility expansion.
    Strategy: Prepare for breakout, scale in gradually.
}

\strong{Volatility Breakout Signal}

When short-term volatility exceeds 1.5Ã— medium-term volatility, it indicates:
\itemize{
  \item A volatility expansion event is occurring
  \item Momentum is accelerating in one direction
  \item Trend-following strategies should be employed
}

\strong{Volatility Compression Signal}

When short-term volatility falls below 0.5Ã— medium-term volatility, it indicates:
\itemize{
  \item Market is consolidating / range-bound
  \item Volatility is contracting (calm before the storm)
  \item Mean reversion strategies should be employed
  \item A volatility expansion is likely approaching
}
}
\note{
\itemize{
  \item The first \code{max(windows)} observations will have NA values for
    volatility calculations.
  \item Annualization uses 365 days (crypto trades 24/7) rather than 252
    (traditional markets). Adjust if you prefer different conventions.
  \item Percentile ranks are calculated over the entire dataset and will
    change as new data is added.
  \item The 1.5Ã— and 0.5Ã— thresholds are configurable based on backtesting.
}
}
\section{Trading Strategy Selection}{

Use volatility regimes to select appropriate trading strategies:

\describe{
  \item{\strong{Extreme Low Regime}}{%
    \itemize{
      \item \strong{Strategy:} Prepare for breakout
      \item \strong{Position Sizing:} Scale in gradually
      \item \strong{Stop Loss:} Wide
    }
  }
  \item{\strong{Low Regime}}{%
    \itemize{
      \item \strong{Strategy:} Trend following
      \item \strong{Position Sizing:} Full size
      \item \strong{Stop Loss:} Wider
    }
  }
  \item{\strong{High Regime}}{%
    \itemize{
      \item \strong{Strategy:} Active trading
      \item \strong{Position Sizing:} Reduced size
      \item \strong{Stop Loss:} Tight
    }
  }
  \item{\strong{Extreme High Regime}}{%
    \itemize{
      \item \strong{Strategy:} Capitulation - wait
      \item \strong{Position Sizing:} Cash/minimal
      \item \strong{Stop Loss:} Very tight
    }
  }
}
}

\examples{
\dontrun{
# Get market data and calculate on-chain indicators first
market <- get_market_data("Bitcoin", "2018-01-01")
onchain <- get_onchain_indicators(market$data)

# Calculate volatility metrics
vol <- get_volatility(onchain)

# View current volatility regime
cat("Current regime:", tail(vol$regime, 1), "\n")
cat("Market environment:", vol$signals$current_regime, "\n")

# Check for volatility signals
if (tail(vol$signals$vol_compression, 1)) {
  cat("âš ï¸  Volatility compression detected - prepare for breakout\n")
  cat("Recommended strategy: Mean reversion, range trading\n")
} else if (tail(vol$signals$vol_breakout, 1)) {
  cat("ðŸš€ Volatility breakout detected - trend in progress\n")
  cat("Recommended strategy: Trend following, momentum\n")
}

# Plot volatility with regimes
library(ggplot2)
vol_df <- data.frame(
  date = tail(onchain$timestamp, 500),
  vol_short = tail(vol$volatility$short, 500),
  vol_medium = tail(vol$volatility$medium, 500),
  regime = tail(vol$regime, 500)
)

ggplot(vol_df, aes(x = date)) +
  geom_line(aes(y = vol_short, color = "Short-term Vol"), size = 0.8) +
  geom_line(aes(y = vol_medium, color = "Medium-term Vol"), size = 0.8) +
  geom_hline(yintercept = mean(vol_df$vol_medium, na.rm = TRUE),
             linetype = "dashed", alpha = 0.5) +
  scale_color_manual(values = c("Short-term Vol" = "darkblue",
                                "Medium-term Vol" = "red")) +
  labs(title = "Bitcoin Realized Volatility",
       subtitle = "Short-term (7d) vs Medium-term (30d)",
       y = "Annualized Volatility", x = "Date") +
  theme_minimal()

# Volatility percentile analysis
current_percentile <- tail(vol$volatility$percentile_medium, 1)
cat("Current volatility percentile:",
    round(current_percentile * 100, 1), "\%\n")

if (current_percentile > 0.9) {
  cat("Warning: Volatility in top 10\% historically\n")
} else if (current_percentile < 0.1) {
  cat("Alert: Volatility in bottom 10\% historically\n")
}
}

}
\references{
\itemize{
  \item Andersen, T. G., & Bollerslev, T. (1998). Answering the Skeptics:
    Yes, Standard Volatility Models Do Provide Accurate Forecasts
  \item Patton, A. J. (2011). Volatility Forecast Comparison Using Imperfect
    Volatility Proxies
  \item CBOE (2023). VIX Index Rules of Construction
}
}
\seealso{
\itemize{
  \item \code{\link{get_onchain_indicators}} for source log returns
  \item \code{\link{get_derivatives}} for positioning context
  \item \code{\link{crypto_predictive_framework}} for integrated analysis
}
}
\author{
Your Name
}
