% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/helpers.R
\name{get_positioning}
\alias{get_positioning}
\title{Fetch Whale Transaction Data and Retail Sentiment Indicators}
\usage{
get_positioning(
  api_key = NULL,
  start_time = "2026-02-01",
  google_trends_keywords = c("bitcoin", "crypto", "blockchain")
)
}
\arguments{
\item{api_key}{Character string containing your Whale Alert API key.
Default NULL expects key to be set in \code{global_variables$whaleAlert_api_key}.
Get a free API key at \url{https://whale-alert.io/api}}

\item{start_time}{Start time for whale transaction lookup in "YYYY-MM-DD" format.
Default "2026-02-01". Transactions are fetched from this time to present.}

\item{google_trends_keywords}{Character vector of keywords to track for retail
sentiment. Default c("bitcoin", "crypto", "blockchain").}
}
\value{
A list object of class \code{positioning_data} containing:

  \strong{Exchange Positioning:}
  \itemize{
    \item \code{netflow_summary}: Data frame with:
      \itemize{
        \item \code{inflow_usd}: Total USD value moving from unknown wallets to exchanges
        \item \code{outflow_usd}: Total USD value moving from exchanges to unknown wallets
        \item \code{tx_count}: Total number of whale transactions
        \item \code{pct}: Percentage of transactions above half of max transaction size
        \item \code{netflow_usd}: Net flow (inflow - outflow)
      }
    \item \code{flow_regime}: Categorical interpretation of whale flows:
      \itemize{
        \item "Extreme Inflows (Heavy Selling Pressure)": Net inflows > 10Ã— max tx size
        \item "Net Inflows (Bearish Bias)": Positive net inflows
        \item "Neutral / Balanced": Net flows near zero
        \item "Net Outflows (Bullish Bias)": Negative net inflows
        \item "Extreme Outflows (Heavy Accumulation)": Net outflows > 10Ã— max tx size
      }
    \item \code{top_exchange_target}: Most common exchange receiving whale inflows
  }

  \strong{Whale Activity Metrics:}
  \itemize{
    \item \code{total_tx}: Total number of whale transactions in the period
    \item \code{whale_signal}: Activity level interpretation:
      \itemize{
        \item "High Whale Intensity (Volatility Expected)": >50% of transactions are large
        \item "Normal Whale Activity": Typical distribution of transaction sizes
        \item "Low Whale Activity": <10% of transactions are large
      }
    \item \code{largest_move_usd}: Size of the largest transaction in USD
  }

  \strong{Raw Data:}
  \itemize{
    \item \code{raw_whale_data}: Detailed transaction data for custom analysis
  }

  \strong{Retail Sentiment (Google Trends):}
  \itemize{
    \item \code{google_trends}: List containing:
      \itemize{
        \item \code{interest_over_time}: Historical search interest (0-100 scale)
        \item \code{related_queries}: Related search terms and their popularity
        \item \code{interest_by_region}: Geographic breakdown of search interest
        \item \code{current_sentiment}: Average search interest over last 7 days
        \item \code{sentiment_signal}: Categorical interpretation:
          \itemize{
            \item "Extreme Interest (Potential Top)": Score > 80
            \item "High Interest": Score 60-80
            \item "Normal Interest": Score 20-60
            \item "Low Interest (Potential Bottom)": Score < 20
          }
        \item \code{keywords}: Keywords tracked
      }
  }
}
\description{
Retrieves and analyzes large cryptocurrency transactions ("whale movements")
from Whale Alert and retail sentiment from Google Trends. This function provides
critical insights into "smart money" positioning and retail interest extremes,
which often precede significant market moves.
}
\details{
\strong{Why Whale Transactions Matter}

Large holders ("whales") often have superior information and their on-chain
movements can signal upcoming market moves:

\strong{Exchange Inflows (Selling Pressure)}

When whales move coins from private wallets to exchanges, it typically
indicates an intent to sell. This creates sell-side pressure:
\itemize{
  \item \strong{Normal inflows}: Routine trading activity
  \item \strong{Extreme inflows (>10Ã— normal)}: Potential distribution event,
    often preceding price declines
  \item \strong{Interpretation}: "If it's on the exchange, it's for sale"
}

\strong{Exchange Outflows (Accumulation)}

When whales move coins from exchanges to private wallets, it typically
indicates accumulation (taking custody for long-term holding):
\itemize{
  \item \strong{Normal outflows}: Routine withdrawal after purchase
  \item \strong{Extreme outflows (>10Ã— normal)}: Significant accumulation,
    often preceding price appreciation
  \item \strong{Interpretation}: "Not your keys, not your coins" - whales
    moving to cold storage signals long-term conviction
}

\strong{Whale Transaction Intensity}

The concentration of large transactions provides additional context:
\itemize{
  \item \strong{High intensity}: Multiple whale-sized moves suggest
    important market participants are active â†’ increased volatility expected
  \item \strong{Low intensity}: Whale inactivity can signal indecision
    or consolidation phase
}

\strong{Why Retail Sentiment (Google Trends) Matters}

Google Trends provides a real-time measure of retail attention, which
often acts as a contrary indicator at extremes:

\strong{Extreme Interest (>80)}

When search interest reaches euphoric levels:
\itemize{
  \item Typically occurs near price tops (e.g., Dec 2017, April 2021)
  \item Signals that "everyone who wants to buy has already bought"
  \item Often precedes distribution phase and price declines
  \item \strong{Trading implication}: Consider taking profits, reducing exposure
}

\strong{Low Interest (<20)}

When retail loses interest completely:
\itemize{
  \item Typically occurs near price bottoms (e.g., Dec 2018, June 2022)
  \item Signals that selling pressure is exhausted (no one left to sell)
  \item Smart money often accumulates during retail apathy
  \item \strong{Trading implication}: Look for accumulation opportunities
}

\strong{Normal Interest (20-60)}

Healthy, sustainable interest levels:
\itemize{
  \item Organic growth without euphoria
  \item Typically accompanies steady trends
  \item \strong{Trading implication}: Let trends run, no contrary signal
}
}
\note{
\itemize{
  \item Whale Alert API has rate limits (free tier: 1 request per minute)
  \item Only tracks transactions > $500,000 (or currency equivalent)
  \item Google Trends data may be delayed by 1-2 days
  \item Sentiment signals are contrarian at extremes, confirming in trends
  \item Different exchanges may have different wallet labeling accuracy
}
}
\section{Combined Interpretation Framework}{


The most powerful signals come from combining whale flows with retail sentiment:

\describe{
  \item{\strong{Bullish Confluence}}{%
    \itemize{
      \item Whale outflows (accumulation) + Low retail interest
      \item Interpretation: Smart money accumulating while retail is apathetic
      \item Action: Strong accumulation signal, scale into positions
    }
  }
  \item{\strong{Bearish Confluence}}{%
    \itemize{
      \item Whale inflows (distribution) + High retail interest
      \item Interpretation: Smart money selling to euphoric retail
      \item Action: Reduce exposure, consider shorts
    }
  }
  \item{\strong{Mixed Signals}}{%
    \itemize{
      \item Divergence between whale and retail indicators
      \item Interpretation: Transition phase, wait for confirmation
      \item Action: Reduce position size, tighten stops
    }
  }
}
}

\examples{
\dontrun{
# Basic usage with API key
positioning <- get_positioning(
  api_key = "your_whale_alert_key",
  start_time = Sys.Date() - 7,
  google_trends_keywords = c("bitcoin", "ethereum", "crypto")
)

# Check whale flow regime
cat("Whale Flow:", positioning$exchange_positioning$flow_regime, "\n")
cat("Net Flow: $",
    format(positioning$exchange_positioning$netflow_summary$netflow_usd,
           big.mark = ",", scientific = FALSE), "\n")

# Interpret whale activity
if (grepl("Extreme Inflows", positioning$exchange_positioning$flow_regime)) {
  cat("âš ï¸  Warning: Whales moving to exchanges - potential selling pressure\n")
} else if (grepl("Extreme Outflows", positioning$exchange_positioning$flow_regime)) {
  cat("ðŸš€ Bullish: Whales accumulating - moving to cold storage\n")
}

# Check retail sentiment
if (!is.null(positioning$google_trends)) {
  sentiment <- positioning$google_trends$sentiment_signal
  score <- positioning$google_trends$current_sentiment

  cat("Retail Sentiment:", sentiment, sprintf("(Score: \%.1f)", score), "\n")

  if (grepl("Extreme Interest", sentiment)) {
    cat("âš ï¸  Retail euphoria - potential top\n")
  } else if (grepl("Low Interest", sentiment)) {
    cat("ðŸŸ¢ Retail apathy - potential bottom\n")
  }
}

# Combined signal
if (!is.null(positioning$google_trends)) {
  whale_bearish <- grepl("Inflows", positioning$exchange_positioning$flow_regime)
  retail_bullish <- grepl("Low Interest", positioning$google_trends$sentiment_signal)

  if (whale_bearish && retail_bullish) {
    cat("âš ï¸  Divergence: Whales selling, retail apathetic - wait for clarity\n")
  }
}

# Plot whale flows over time
library(ggplot2)
whale_history <- positioning$raw_whale_data \%>\%
  mutate(date = as.Date(as.POSIXct(timestamp))) \%>\%
  group_by(date) \%>\%
  summarise(
    inflow = sum(amount_usd[to_type == "exchange"], na.rm = TRUE),
    outflow = sum(amount_usd[from_type == "exchange"], na.rm = TRUE),
    netflow = inflow - outflow
  )

ggplot(whale_history, aes(x = date)) +
  geom_col(aes(y = inflow, fill = "Inflows (Selling)"), alpha = 0.7) +
  geom_col(aes(y = -outflow, fill = "Outflows (Buying)"), alpha = 0.7) +
  scale_fill_manual(values = c("Inflows (Selling)" = "red",
                               "Outflows (Buying)" = "green")) +
  labs(title = "Whale Exchange Flows",
       subtitle = "Positive = Inflows (Selling), Negative = Outflows (Buying)",
       y = "USD Value", x = "Date") +
  theme_minimal()
}

}
\references{
\itemize{
  \item Whale Alert: \url{https://whale-alert.io/}
  \item Google Trends: \url{https://trends.google.com/}
  \item Da, Z., Engelberg, J., & Gao, P. (2011). In Search of Attention
  \item Preis, T., Moat, H. S., & Stanley, H. E. (2013). Quantifying Trading
    Behavior in Financial Markets Using Google Trends
}
}
\seealso{
\itemize{
  \item \code{\link{get_derivatives}} for exchange positioning via funding rates
  \item \code{\link{get_onchain_indicators}} for fundamental valuation
  \item \code{\link{crypto_predictive_framework}} for integrated analysis
}
}
\author{
Your Name
}
